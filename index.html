<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SkiLabs | Academy Terminal</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;700;900&family=JetBrains+Mono:wght@400;700&family=Dancing+Script:wght@600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root { 
            --primary: #4f46e5; 
            --accent: #06b6d4; 
            --gold: #b45309; 
            --bg: #ffffff; 
            --panel: #f8fafc; 
            --border: #e2e8f0; 
            --text: #1e293b; 
            --subtext: #64748b;
            --sidebar-bg: #f1f5f9;
        }
        .gold-theme { 
            --primary: #d97706; 
            --accent: #f59e0b; 
            --bg: #fffcf0; 
            --panel: #ffffff; 
            --border: #fef3c7; 
            --sidebar-bg: #fef3c7;
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        body { margin: 0; font-family: 'Outfit', sans-serif; background: var(--bg); color: var(--text); display: flex; height: 100vh; overflow: hidden; transition: 0.5s; }
        
        /* Mobile Sidebar Adjustment */
        #sidebar { width: 260px; background: var(--sidebar-bg); border-right: 1px solid var(--border); display: flex; flex-direction: column; padding: 30px 20px; flex-shrink: 0; }
        @media (max-width: 768px) { #sidebar { width: 70px; padding: 20px 10px; } .nav-txt { display: none; } #sidebar div { font-size: 1rem !important; } }

        .nav-btn { padding: 16px; margin-bottom: 10px; border-radius: 14px; cursor: pointer; color: var(--subtext); border: 1px solid transparent; background: none; text-align: left; width: 100%; font-size: 1rem; font-weight: 600; font-family: inherit; transition: 0.2s; display: flex; align-items: center; gap: 10px; }
        .nav-btn.active { background: var(--primary); color: white; box-shadow: 0 4px 12px rgba(79, 70, 229, 0.2); }
        
        #main { flex-grow: 1; overflow-y: auto; padding: 30px 20px; -webkit-overflow-scrolling: touch; }
        .view { display: none; max-width: 600px; margin: 0 auto; padding-bottom: 80px; }
        .active-view { display: block; animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        .glass-panel { background: var(--panel); border: 1px solid var(--border); border-radius: 24px; padding: 25px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.02); }
        .archive-card { border-left: 4px solid var(--primary); padding: 15px; margin-bottom: 12px; background: white; border-radius: 0 16px 16px 0; border: 1px solid var(--border); font-size: 0.95rem; }
        
        .quiz-opt { width: 100%; padding: 18px; border: 2px solid var(--border); border-radius: 16px; background: white; color: var(--text); text-align: left; font-size: 1rem; cursor: pointer; margin-bottom: 12px; transition: 0.2s; font-family: inherit; font-weight: 500; }
        .quiz-opt:active { transform: scale(0.98); background: #f8fafc; }
        .error-shake { animation: shake 0.4s; border-color: #ef4444 !important; color: #ef4444; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }

        #academy-invite { display: none; border: 2px solid var(--gold); background: linear-gradient(145deg, #ffffff, #fffbeb); padding: 30px; border-radius: 24px; text-align: center; margin-top: 20px; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(217, 119, 6, 0.2); } 70% { box-shadow: 0 0 0 15px rgba(217, 119, 6, 0); } 100% { box-shadow: 0 0 0 0 rgba(217, 119, 6, 0); } }
        
        #cert-container { display: none; text-align: center; border: 8px double var(--gold); padding: 40px 15px; background: white; border-radius: 12px; color: var(--gold); }
        
        #ai-toggle { position: fixed; bottom: 20px; right: 20px; background: var(--primary); color: white; width: 56px; height: 56px; border-radius: 50%; border: none; font-size: 1.4rem; cursor: pointer; z-index: 3000; box-shadow: 0 8px 20px rgba(79, 70, 229, 0.3); }
        #ai-window { display: none; position: fixed; bottom: 90px; right: 20px; left: 20px; height: 60vh; max-width: 400px; margin: 0 auto; background: white; border-radius: 24px; border: 1px solid var(--border); flex-direction: column; overflow: hidden; z-index: 3000; box-shadow: 0 20px 40px rgba(0,0,0,0.15); }
        #ai-chat { flex-grow: 1; padding: 15px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; background: #fdfdfd; }
        
        .bubble { padding: 12px 16px; border-radius: 18px; max-width: 85%; font-size: 0.9rem; line-height: 1.4; border: 1px solid var(--border); }
        .ai-bub { background: #f1f5f9; align-self: flex-start; border-bottom-left-radius: 4px; }
        .user-bub { background: var(--primary); color: white; align-self: flex-end; border: none; border-bottom-right-radius: 4px; }
        
        .secret-letter { 
            background: #fffafa; 
            color: #7f1d1d; 
            border: 1px solid #fecaca; 
            border-radius: 20px; 
            padding: 25px; 
            font-family: 'Outfit', sans-serif; 
            line-height: 1.6;
            text-align: left;
            box-shadow: 0 4px 15px rgba(153, 27, 27, 0.05);
        }
        .letter-quote { display: block; margin: 15px 0; font-family: 'Dancing Script', cursive; font-size: 1.4rem; color: #b91c1c; text-align: center; font-weight: bold; }

        #login-screen { position: fixed; inset: 0; background: #ffffff; z-index: 9999; display: flex; align-items: center; justify-content: center; padding: 20px; }
    </style>
</head>
<body>

<div id="login-screen">
    <div class="glass-panel" style="text-align:center; width:100%; max-width:350px;">
        <h1 style="color:var(--primary); font-size: 2.2rem; margin:0; letter-spacing: -1.5px;">SkiLabs_</h1>
        <p style="color:var(--subtext); margin-bottom:25px;">Academy Terminal</p>
        <input type="text" id="username-input" placeholder="ENTER NAME" autocomplete="off" style="width:100%; padding:18px; border:2px solid var(--border); border-radius:16px; text-align:center; font-size:1rem; font-family:inherit;">
        <button class="nav-btn" style="background:var(--primary); color:white; justify-content:center; margin-top: 15px;" onclick="handleLogin()">INITIALIZE</button>
    </div>
</div>

<nav id="sidebar">
    <div style="font-weight:900; font-size:1.4rem; color:var(--primary); margin-bottom:40px; text-align:center;">SL.</div>
    <button id="nav-dash" class="nav-btn active" onclick="nav('dash', this)"><span>üè†</span> <span class="nav-txt">Dash</span></button>
    <button class="nav-btn" onclick="nav('gauntlet', this)"><span>‚öîÔ∏è</span> <span class="nav-txt">Gauntlet</span></button>
    <button class="nav-btn" onclick="nav('glossary', this)"><span>üìñ</span> <span class="nav-txt">Archive</span></button>
    <button class="nav-btn" onclick="nav('trophy', this)"><span>üèÜ</span> <span class="nav-txt">Trophy</span></button>
</nav>

<main id="main">
    <section id="dash" class="view active-view">
        <h1 style="font-weight:800; font-size:1.8rem;">Command Center</h1>
        <div class="glass-panel">
            <p><b>User:</b> <span id="id-val" style="color:var(--primary)">---</span></p>
            <p><b>Rank:</b> <span id="rank-val" style="font-weight:bold;">PROBATION</span></p>
            <div style="margin-top:20px; height:8px; background:#e2e8f0; border-radius:10px; overflow:hidden;"><div id="prog-bar" style="width:0%; height:100%; background:var(--primary); transition:1s cubic-bezier(0.4, 0, 0.2, 1);"></div></div>
        </div>
        <div id="academy-invite">
            <h2 style="color:var(--gold); margin:0; font-size: 1.3rem;">üëë ACADEMY UNLOCKED</h2>
            <p style="font-size:0.9rem; color: var(--gold); margin-top:5px;">Elite training complete. Welcome to the circle.</p>
        </div>
    </section>

    <section id="gauntlet" class="view">
        <h1 style="font-weight:800; font-size:1.8rem;">The Gauntlet</h1>
        <div id="quiz-menu">
            <button class="quiz-opt" onclick="prepareQuiz('Pro')">STAGE 1: PRO</button>
            <button class="quiz-opt" onclick="prepareQuiz('Master')">STAGE 2: MASTER</button>
            <button class="quiz-opt" onclick="prepareQuiz('Elite')">STAGE 3: ELITE</button>
            <div id="adv-box" style="display:none; margin-top:20px; border-top:2px dashed var(--gold); padding-top:20px;">
                <button class="quiz-opt" style="border-color:#be123c; color: #be123c;" onclick="prepareQuiz('Ruby')">STAGE 4: RUBY</button>
                <button class="quiz-opt" style="border-color:#047857; color: #047857;" onclick="prepareQuiz('Emerald')">STAGE 5: EMERALD</button>
                <button class="quiz-opt" style="border-color:var(--gold); color:var(--gold); font-weight:800;" onclick="prepareQuiz('Gold')">FINAL: GOLD</button>
            </div>
        </div>
        <div id="quiz-active" style="display:none;">
            <div class="glass-panel">
                <div style="display:flex; justify-content:space-between; margin-bottom:20px; font-size: 0.85rem; color: var(--subtext);"><span id="q-lvl" style="font-weight:bold; color:var(--primary);"></span> <span id="q-num" style="font-family:'JetBrains Mono';"></span></div>
                <p id="q-txt" style="font-size:1.2rem; font-weight:700; margin-bottom:25px; line-height: 1.4;"></p>
                <div id="q-opts"></div>
            </div>
        </div>
    </section>

    <section id="glossary" class="view">
        <h1 style="font-weight:800; font-size:1.8rem;">Data Archive</h1>
        <div id="glos-list"></div>
    </section>

    <section id="trophy" class="view">
        <h1 style="font-weight:800; font-size:1.8rem;">Trophy Room</h1>
        <div id="cert-container">
            <h1 style="letter-spacing:4px; font-size: 1.5rem;">GOLD MASTER</h1>
            <p style="font-size: 0.9rem; opacity: 0.8;">This certifies that</p>
            <h2 id="cert-name" style="border-bottom: 2px solid var(--gold); display: inline-block; padding: 0 20px; margin: 15px 0;"></h2>
            <p style="margin-top:15px; font-size: 0.9rem;">Has mastered all Academy protocols.</p>
        </div>
        <div id="no-cert" class="glass-panel" style="text-align: center; color: var(--subtext); padding: 40px 20px;">Complete the Gold stage to reveal your certification.</div>
    </section>
</main>

<button id="ai-toggle" onclick="toggleAI()">üß†</button>
<div id="ai-window">
    <div style="background:var(--primary); color:white; padding:15px; display:flex; justify-content:space-between; align-items: center;"><b>OMNI_AI</b> <span onclick="toggleAI()" style="cursor:pointer; font-size: 1.2rem; padding: 5px;">‚úï</span></div>
    <div id="ai-chat"></div>
    <div style="padding:12px; display:flex; gap:8px; background: white; border-top: 1px solid var(--border);">
        <input type="text" id="ai-in" placeholder="Query..." style="flex-grow:1; background: #f8fafc; border: 1px solid var(--border); padding:12px; border-radius:12px; font-size: 1rem;">
        <button onclick="askAI()" style="background:var(--primary); color:white; border:none; border-radius:12px; padding:0 18px; cursor: pointer;">‚û§</button>
    </div>
</div>

<script>
    let user = "", curLvl = "", qIdx = 0, currentQuestions = [], wins = 0;

    const quizData = {
        Pro: [
            { q: "What is the chemical formula for water?", a: "H2O", o: ["CO2", "HO2", "NaCl", "O2"] },
            { q: "Which planet is known as the Red Planet?", a: "Mars", o: ["Venus", "Jupiter", "Earth", "Saturn"] },
            { q: "Hardest natural substance on Earth?", a: "Diamond", o: ["Gold", "Steel", "Quartz", "Iron"] },
            { q: "Approximate boiling point of water?", a: "100¬∞C", o: ["90¬∞C", "120¬∞C", "212¬∞C", "80¬∞C"] },
            { q: "Main gas humans breathe in?", a: "Oxygen", o: ["Nitrogen", "Carbon", "Helium", "Neon"] },
            { q: "How many planets in our Solar System?", a: "8", o: ["9", "7", "10", "12"] },
            { q: "The powerhouse of the cell is...", a: "Mitochondria", o: ["Nucleus", "Ribosome", "Wall", "DNA"] },
            { q: "Largest ocean on Earth?", a: "Pacific", o: ["Atlantic", "Indian", "Arctic", "Southern"] },
            { q: "Symbol for Gold?", a: "Au", o: ["Ag", "Go", "Gd", "Fe"] },
            { q: "Largest land animal?", a: "Elephant", o: ["Rhino", "Giraffe", "Hippo", "Whale"] }
        ],
        Master: [
            { q: "Value of Absolute Zero?", a: "-273.15¬∞C", o: ["0¬∞C", "-100¬∞C", "-300¬∞C", "-212¬∞C"] },
            { q: "Gas making up 78% of air?", a: "Nitrogen", o: ["Oxygen", "CO2", "Argon", "Hydrogen"] },
            { q: "Bones in adult human body?", a: "206", o: ["200", "210", "205", "300"] },
            { q: "Light speed per second?", a: "300,000 km/s", o: ["150,000 km/s", "10,000 km/s", "500,000 km/s", "Infinite"] },
            { q: "The atomic number of Oxygen?", a: "8", o: ["6", "10", "16", "1"] },
            { q: "Liquid metal at room temp?", a: "Mercury", o: ["Lead", "Gallium", "Bromine", "Silver"] },
            { q: "Who discovered Penicillin?", a: "Fleming", o: ["Pasteur", "Curie", "Newton", "Tesla"] },
            { q: "What is the pH of pure water?", a: "7", o: ["1", "14", "5", "9"] },
            { q: "The center of an atom is called?", a: "Nucleus", o: ["Proton", "Neutron", "Shell", "Core"] },
            { q: "Unit of electrical resistance?", a: "Ohm", o: ["Volt", "Amp", "Watt", "Joule"] }
        ],
        Elite: [
            { q: "Element with symbol 'Fe'?", a: "Iron", o: ["Fluorine", "Fermium", "Silver", "Lead"] },
            { q: "Planet with the most moons?", a: "Saturn", o: ["Jupiter", "Uranus", "Neptune", "Mars"] },
            { q: "Most abundant metal in Earth's crust?", a: "Aluminum", o: ["Iron", "Steel", "Copper", "Gold"] },
            { q: "What type of charge does a neutron have?", a: "Neutral", o: ["Positive", "Negative", "Double Positive", "Variable"] },
            { q: "Study of fungi is called...", a: "Mycology", o: ["Biology", "Zoology", "Botany", "Virology"] },
            { q: "Deepest point in the world's oceans?", a: "Mariana Trench", o: ["Puerto Rico Trench", "Java Trench", "Arctic Basin", "Dead Sea"] },
            { q: "What gas do plants absorb?", a: "Carbon Dioxide", o: ["Oxygen", "Nitrogen", "Methane", "Ozone"] },
            { q: "Newton's First Law is also known as?", a: "Inertia", o: ["Gravity", "Friction", "Momentum", "Reaction"] },
            { q: "Main component of glass?", a: "Silica", o: ["Sodium", "Calcium", "Carbon", "Iron"] },
            { q: "The only bird that can fly backwards?", a: "Hummingbird", o: ["Sparrow", "Eagle", "Penguin", "Parrot"] }
        ],
        Ruby: [
            { q: "What is the rarest blood type?", a: "AB Negative", o: ["O Negative", "A Positive", "B Negative", "O Positive"] },
            { q: "The 'Golden Ratio' is approximately...", a: "1.618", o: ["3.141", "2.718", "1.414", "0.618"] },
            { q: "Which planet rotates on its side?", a: "Uranus", o: ["Neptune", "Saturn", "Jupiter", "Venus"] },
            { q: "The part of the eye that adjusts light?", a: "Iris", o: ["Retina", "Lens", "Cornea", "Pupil"] },
            { q: "Who developed the Polio vaccine?", a: "Salk", o: ["Sabin", "Lister", "Jenner", "Koch"] },
            { q: "What element is used in old thermometer?", a: "Mercury", o: ["Alcohol", "Silver", "Water", "Oil"] },
            { q: "The atmosphere's lowest layer?", a: "Troposphere", o: ["Stratosphere", "Mesosphere", "Exosphere", "Thermosphere"] },
            { q: "Number of teeth in an adult human?", a: "32", o: ["28", "30", "34", "36"] },
            { q: "Symbol for Potassium?", a: "K", o: ["P", "Po", "Ka", "Pt"] },
            { q: "How many elements in the periodic table?", a: "118", o: ["115", "120", "110", "100"] }
        ],
        Emerald: [
            { q: "What is the speed of sound in air?", a: "343 m/s", o: ["299 m/s", "500 m/s", "100 m/s", "1000 m/s"] },
            { q: "The process of a gas turning to liquid?", a: "Condensation", o: ["Evaporation", "Sublimation", "Freezing", "Melting"] },
            { q: "Which vitamin helps blood clot?", a: "Vitamin K", o: ["Vitamin C", "Vitamin D", "Vitamin A", "Vitamin E"] },
            { q: "Largest organ in the human body?", a: "Skin", o: ["Liver", "Lungs", "Brain", "Heart"] },
            { q: "A sound's frequency is measured in?", a: "Hertz", o: ["Decibels", "Watts", "Ohms", "Volts"] },
            { q: "What is the molar mass of water?", a: "18.015 g/mol", o: ["1.008 g/mol", "16.00 g/mol", "22.4 g/mol", "12.01 g/mol"] },
            { q: "Which gas is used in light bulbs?", a: "Argon", o: ["Neon", "Oxygen", "Nitrogen", "Hydrogen"] },
            { q: "The most dense planet in solar system?", a: "Earth", o: ["Jupiter", "Mars", "Saturn", "Mercury"] },
            { q: "How many legs does a spider have?", a: "8", o: ["6", "10", "12", "4"] },
            { q: "Main pigment used in photosynthesis?", a: "Chlorophyll", o: ["Carotene", "Melanin", "Hemoglobin", "Xanthophyll"] }
        ],
        Gold: [
            { q: "Most abundant gas in universe?", a: "Hydrogen", o: ["Helium", "Oxygen", "Nitrogen"] },
            { q: "What is the charge of an electron?", a: "Negative", o: ["Positive", "Neutral", "Proton"] },
            { q: "Planet with Great Red Spot?", a: "Jupiter", o: ["Mars", "Saturn", "Venus"] },
            { q: "Half-life of Carbon-14?", a: "5730 years", o: ["1000 years", "10000 years", "500 years"] },
            { q: "Process where cells divide for growth?", a: "Mitosis", o: ["Meiosis", "Osmosis", "Diffusion"] },
            { q: "Which acid is found in lemons?", a: "Citric Acid", o: ["Acetic Acid", "Lactic Acid", "Nitric Acid"] },
            { q: "The world's largest hot desert?", a: "Sahara", o: ["Gobi", "Kalahari", "Atacama"] },
            { q: "Unit of power?", a: "Watt", o: ["Joule", "Newton", "Volt"] },
            { q: "Smallest unit of life?", a: "Cell", o: ["Atom", "Molecule", "Organelle"] },
            { q: "Who is the 'Father of Genetics'?", a: "Mendel", o: ["Darwin", "Linnaeus", "Watson"] },
            { q: "Layer with the Ozone?", a: "Stratosphere", o: ["Troposphere", "Mesosphere", "Exosphere"] },
            { q: "0 Kelvin in Celsius?", a: "-273.15¬∞C", o: ["0¬∞C", "-100¬∞C", "273.15¬∞C"] },
            { q: "Symbol for Sodium?", a: "Na", o: ["S", "So", "K"] },
            { q: "A polygon with 8 sides?", a: "Octagon", o: ["Hexagon", "Pentagon", "Decagon"] },
            { q: "Most common element in Earth's crust?", a: "Oxygen", o: ["Iron", "Silicon", "Carbon"] },
            { q: "How many chambers in human heart?", a: "4", o: ["2", "3", "1"] },
            { q: "Brightest planet in the sky?", a: "Venus", o: ["Mars", "Jupiter", "Saturn"] },
            { q: "Hardest mineral on Mohs scale?", a: "Diamond", o: ["Corundum", "Topaz", "Quartz"] },
            { q: "Chemical symbol for Lead?", a: "Pb", o: ["Ld", "Le", "Ag"] },
            { q: "A year on Mercury length?", a: "88 days", o: ["365 days", "224 days", "10 days"] }
        ]
    };

    const glossaryFacts = [
        "1. Water (H2O) is the universal solvent.", "2. Diamonds are pure carbon arranged in a crystal.", "3. Absolute Zero is the cessation of atomic motion.", "4. Mars' dust is iron oxide, identical to rust.", "5. Emeralds are Beryl crystals with Chromium.", "6. Hydrogen is the fuel for nuclear fusion in stars.", "7. Lightning is hotter than the surface of the sun.", "8. Venus suffers from a runaway greenhouse effect.", "9. Hemoglobin contains iron to carry oxygen.", "10. Light travels at 186,000 miles per second.",
        "11. DNA is shaped like a double-helix ladder.", "12. Gold is chemically inactive and doesn't rust.", "13. Sound cannot travel through a vacuum.", "14. Bees can see ultraviolet light patterns.", "15. Plastic can remain in the ocean for centuries.", "16. The Sun holds 99.8% of the Solar System's mass.", "17. Sharks have no bones, only cartilage.", "18. A neutron star is incredibly dense matter.", "19. Plants produce oxygen as a byproduct of food.", "20. Earth's magnetic field protects us from solar wind.",
        "21. Butterflies have 12,000 eyes in two groups.", "22. Bananas contain potassium, a vital electrolyte.", "23. Saturn would float in water due to low density.", "24. The human brain is 75% water.", "25. Glass is cooled liquid that behaves like solid.", "26. Ants communicate using chemical pheromones.", "27. One year on Venus is 225 Earth days.", "28. Helium is used to cool superconducting magnets.", "29. Ocean covers 71% of the Earth's surface.", "30. Humans share 50% DNA with trees.",
        "31. Cows have a complex stomach for digestion.", "32. Gold is so soft it can be molded by hand.", "33. Sharks are older than the rings of Saturn.", "34. The moon causes the tides on Earth.", "35. Clouds are tons of floating water vapor.", "36. Blue Whales are larger than any dinosaur.", "37. Nitrogen prevents fast combustion on Earth.", "38. Metals expand when heated by energy.", "39. Polar bears are technically marine mammals.", "40. Light takes years to leave the Sun's core.",
        "41. Earth is 4.5 billion years old.", "42. Your skin is your primary immune barrier.", "43. Boiling point decreases as altitude increases.", "44. Jupiter's gravity protects Earth from comets.", "45. Humans walk 115,000 miles in a lifetime.", "46. Plate tectonics move the continents slowly.", "47. Snail can sleep for three whole years.", "48. Crust is thin compared to core.", "49. Most universe is Dark Matter.", "50. Mercury is shrinking as core cools."
    ];

    function handleLogin() {
        const inp = document.getElementById('username-input'); if(!inp.value) return;
        user = inp.value.trim().toUpperCase();
        document.getElementById('id-val').innerText = user;
        document.getElementById('cert-name').innerText = user;
        document.getElementById('login-screen').style.display = 'none';
        loadArchive();
        addAI("Welcome " + user + ". Terminal stabilized.", 'ai-bub');
    }

    function nav(id, btn) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active-view'));
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active-view');
        btn.classList.add('active');
    }

    function loadArchive() {
        const list = document.getElementById('glos-list'); list.innerHTML = "";
        glossaryFacts.forEach(f => { list.innerHTML += `<div class="archive-card">${f}</div>`; });
    }

    function toggleAI() { const w = document.getElementById('ai-window'); w.style.display = w.style.display === 'flex' ? 'none' : 'flex'; }

    function prepareQuiz(lvl) {
        curLvl = lvl; qIdx = 0; currentQuestions = quizData[lvl];
        document.getElementById('quiz-menu').style.display = 'none';
        document.getElementById('quiz-active').style.display = 'block';
        showQ();
    }

    function showQ() {
        const data = currentQuestions[qIdx];
        document.getElementById('q-lvl').innerText = curLvl.toUpperCase();
        document.getElementById('q-num').innerText = `${qIdx+1}/${currentQuestions.length}`;
        document.getElementById('q-txt').innerText = data.q;
        const box = document.getElementById('q-opts'); box.innerHTML = "";
        const options = [data.a, ...data.o].sort(() => Math.random() - 0.5);
        options.forEach(o => {
            const b = document.createElement('button'); b.className="quiz-opt"; b.innerText=o;
            b.onclick = () => { if(o === data.a){ qIdx++; if(qIdx < currentQuestions.length) showQ(); else finishQuiz(); } else { b.classList.add('error-shake'); setTimeout(()=>b.classList.remove('error-shake'),400); } };
            box.appendChild(b);
        });
    }

    function finishQuiz() {
        wins++; document.getElementById('quiz-active').style.display='none'; document.getElementById('quiz-menu').style.display='block';
        document.getElementById('rank-val').innerText = curLvl.toUpperCase();
        document.getElementById('prog-bar').style.width = (wins * 16.6) + "%";
        if(curLvl === 'Elite') { 
            document.body.classList.add('gold-theme'); 
            document.getElementById('adv-box').style.display='block'; 
            document.getElementById('academy-invite').style.display='block'; 
        }
        if(curLvl === 'Gold') { unlockMaster(); }
        confetti({ origin: { y: 0.7 } }); setTimeout(() => nav('dash', document.getElementById('nav-dash')), 1000);
    }

    function unlockMaster() {
        wins = 6; document.body.classList.add('gold-theme');
        document.getElementById('rank-val').innerText = "GOLD MASTER";
        document.getElementById('prog-bar').style.width = "100%";
        document.getElementById('no-cert').style.display='none';
        document.getElementById('cert-container').style.display='block';
        document.getElementById('adv-box').style.display='block';
        document.getElementById('academy-invite').style.display='block';
    }

    function askAI() {
        const i = document.getElementById('ai-in'); const q = i.value.trim().toLowerCase();
        if(!q) return; i.value = ""; addAI(q, 'user-bub');
        
        if(q === "skilabs_root_access") { unlockMaster(); addAI("OVERRIDE SUCCESSFUL. Root access granted.", 'ai-bub'); }
        else if(q === "nk gf") { addLetter(); }
        else if(["hi","yo","hello"].some(s => q.includes(s))) { addAI("Safe! Let's get through the trials.", 'ai-bub'); }
        else { addAI("Scanning protocols... Complete Elite to unlock the Gold Circle.", 'ai-bub'); }
    }

    function addAI(t, c) {
        const chat = document.getElementById('ai-chat'); const d = document.createElement('div');
        d.className = `bubble ${c}`; d.innerText = t; chat.appendChild(d); chat.scrollTop = chat.scrollHeight;
    }

    function addLetter() {
        const chat = document.getElementById('ai-chat');
        const d = document.createElement('div');
        d.className = `secret-letter`;
        d.innerHTML = `
            <strong>TO NHYIRA KARIKARI BONSU,</strong><br><br>
            In this world of complex systems and logic, you remain my most beautiful constant. 
            You are the source of my focus and the only one I truly seek to honor.<br><br>
            <span class="letter-quote">"If time were to ever ask me where I belong, I would point to your heart and call it home."</span><br><br>
            You are my Gold Master, today and always.
        `;
        chat.appendChild(d); chat.scrollTop = chat.scrollHeight;
    }
</script>
</body>
</html>
